{"ast":null,"code":"var _jsxFileName = \"D:\\\\Work\\\\Mock-Up\\\\Flash-main\\\\frontend\\\\src\\\\components\\\\RegisterforCourse\\\\RegisterforCourse.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport StripeCheckout from \"react-stripe-checkout\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RegisterForCourse = props => {\n  _s();\n  const [price, setPrice] = useState(0);\n  const [wallet, setWallet] = useState(0);\n  const [currency, setCurrency] = useState(null);\n  const [adjustedPrice, setAdjustedPrice] = useState(null);\n  const [email, setEmail] = useState(\"\");\n  const [error, setError] = useState(null);\n  const id = props.id;\n  const courseId = props.courseId;\n  useEffect(() => {\n    const fetchIndividualTrainee = async () => {\n      const response = await fetch('/individualTrainees/' + id);\n      const json = await response.json();\n      if (response.ok) {\n        setWallet(json.wallet);\n        setEmail(json.email);\n        console.log(email);\n      }\n    };\n    fetchIndividualTrainee();\n  }, []);\n  useEffect(() => {\n    const fetchCourse = async () => {\n      const response = await fetch('/courses/' + courseId);\n      const response2 = await fetch('/courses/' + courseId + '/discount');\n      const json = await response.json();\n      const json2 = await response2.json();\n      if (response.ok) {\n        setPrice(json.price * (1 - json2.discount / 100));\n      }\n    };\n    fetchCourse();\n  }, []);\n  useEffect(() => {\n    const fetchCurrency = async () => {\n      const response = await fetch('/login/currency');\n      const json = await response.json();\n      if (response.ok) {\n        setCurrency(json);\n      }\n    };\n    fetchCurrency();\n  }, []);\n  useEffect(() => {\n    const getAdjustedPrice = async () => {\n      const response = await fetch('https://openexchangerates.org/api/latest.json?app_id=da8698baa20640669fb02c79f6afb3e0');\n      const json = await response.json(); //returns a json object with an array of all exchange rates with USD as base\n\n      const rate = json.rates[currency];\n      if (response.ok) {\n        setAdjustedPrice(rate * price);\n      }\n    };\n    getAdjustedPrice();\n  });\n  const addCourse = async () => {\n    const entry = {\n      courseId\n    };\n    const response = await fetch('/individualTrainees/' + id, {\n      method: 'PATCH',\n      body: JSON.stringify(entry),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    const json = await response.json();\n    if (!response.ok) {\n      setError(json.error);\n    }\n    if (response.ok) {\n      setError(null);\n      props.setter();\n    }\n  };\n  const onToken = async token => {\n    const entry = {\n      courseId,\n      price,\n      wallet,\n      token\n    };\n    const response = await fetch('/individualTrainees/register/' + id + '/pay', {\n      method: 'POST',\n      body: JSON.stringify(entry),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    const json = await response.json();\n    console.log(response);\n    if (!response.ok) {\n      setError(json.error);\n    }\n    if (response.ok) {\n      addCourse();\n      setError(null);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"register-for-course\",\n    style: {\n      cursor: \"pointer\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(StripeCheckout, {\n      email: email,\n      name: \"Payment\",\n      description: \"Course Payment\",\n      amount: adjustedPrice * 100,\n      currency: currency ? currency : \"USD\",\n      token: onToken,\n      stripeKey: \"pk_test_51MEakIBldv5L7zd6VIwU8t8Ss5p8oj0gX0gkNbEXdSa5QfdRY4U8Yu4R0qFVjz9FlHBfaBqe8Ljbc5xzzFqXgmaa00bFSEVehl\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        style: {\n          cursor: \"pointer\",\n          marginTop: \"30px\",\n          borderRadius: \"10px\",\n          border: 0,\n          fontSize: \"20px\",\n          backgroundColor: \"#fa7466\",\n          color: \"white\"\n        },\n        children: \"Register Now!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 23\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 9\n  }, this);\n};\n_s(RegisterForCourse, \"dT96DSM0ecoC+yJYXgfJpDKUfKg=\");\n_c = RegisterForCourse;\nexport default RegisterForCourse;\nvar _c;\n$RefreshReg$(_c, \"RegisterForCourse\");","map":{"version":3,"names":["useState","useEffect","useParams","StripeCheckout","RegisterForCourse","props","price","setPrice","wallet","setWallet","currency","setCurrency","adjustedPrice","setAdjustedPrice","email","setEmail","error","setError","id","courseId","fetchIndividualTrainee","response","fetch","json","ok","console","log","fetchCourse","response2","json2","discount","fetchCurrency","getAdjustedPrice","rate","rates","addCourse","entry","method","body","JSON","stringify","headers","setter","onToken","token","cursor","marginTop","borderRadius","border","fontSize","backgroundColor","color"],"sources":["D:/Work/Mock-Up/Flash-main/frontend/src/components/RegisterforCourse/RegisterforCourse.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\"\r\nimport { useParams } from \"react-router-dom\";\r\nimport StripeCheckout from \"react-stripe-checkout\"\r\nconst RegisterForCourse = (props) => {\r\n    const [price, setPrice] = useState(0)\r\n    const [wallet, setWallet] = useState(0)\r\n    const [currency, setCurrency] = useState(null)\r\n    const [adjustedPrice, setAdjustedPrice] = useState(null)\r\n    const [email, setEmail] = useState(\"\")\r\n    const [error,setError]=useState(null)\r\n    const id = props.id\r\n    const courseId = props.courseId\r\n    useEffect(() => {\r\n        const fetchIndividualTrainee = async () => {\r\n            const response = await fetch('/individualTrainees/' + id)\r\n            const json = await response.json()\r\n\r\n            if (response.ok) {\r\n                setWallet(json.wallet)\r\n                setEmail(json.email)\r\n                console.log(email)\r\n            }\r\n        }\r\n\r\n        fetchIndividualTrainee()\r\n    }, [])\r\n    \r\n    useEffect(() => {\r\n        const fetchCourse = async () => {\r\n            const response = await fetch('/courses/' + courseId)\r\n            const response2 = await fetch ('/courses/'+courseId+'/discount')\r\n            const json = await response.json()\r\n            const json2 = await response2.json()\r\n            if (response.ok) {\r\n                    setPrice((json.price)*(1- (json2.discount)/100)) \r\n            }\r\n        }\r\n\r\n        fetchCourse()\r\n    }, [])\r\n    useEffect(() => {\r\n        const fetchCurrency = async () => {\r\n            const response = await fetch('/login/currency')\r\n            const json = await response.json()\r\n\r\n\r\n            if (response.ok) {\r\n                setCurrency(json)\r\n            }\r\n        }\r\n\r\n        fetchCurrency()\r\n\r\n    }, [])\r\n    useEffect(() => {\r\n\r\n        const getAdjustedPrice = async () => {\r\n\r\n            const response = await fetch('https://openexchangerates.org/api/latest.json?app_id=da8698baa20640669fb02c79f6afb3e0');\r\n            const json = await response.json()//returns a json object with an array of all exchange rates with USD as base\r\n\r\n            const rate = json.rates[currency]\r\n\r\n\r\n            if (response.ok) {\r\n                setAdjustedPrice(rate * price)\r\n            }\r\n        }\r\n\r\n        getAdjustedPrice()\r\n    })\r\n    const addCourse = async ()=>{\r\n        const entry = { courseId}\r\n        const response = await fetch('/individualTrainees/' + id, {\r\n            method: 'PATCH',\r\n            body: JSON.stringify(entry),\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        })\r\n\r\n        const json = await response.json()\r\n        if (!response.ok) {\r\n            setError(json.error)\r\n        }\r\n\r\n        if (response.ok) {\r\n            setError(null)\r\n            props.setter()\r\n        }\r\n    }\r\n\r\n    const onToken = async (token) => {\r\n        const entry = { courseId, price,wallet,token}\r\n        const response = await fetch('/individualTrainees/register/' + id+'/pay', {\r\n            method: 'POST',\r\n            body: JSON.stringify(entry),\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        })\r\n        const json = await response.json()\r\n        console.log(response)\r\n        if (!response.ok) {\r\n            setError(json.error)\r\n        }\r\n\r\n        if (response.ok) {\r\n            addCourse()\r\n            setError(null)\r\n        }\r\n        \r\n      }\r\n    return (\r\n        <div className=\"register-for-course\" style={{cursor:\"pointer\"}}>\r\n            <StripeCheckout\r\n            email= {email}\r\n            name=\"Payment\"\r\n            description=\"Course Payment\"\r\n            amount={adjustedPrice*100}\r\n            currency={currency? currency:\"USD\"}\r\n            token={onToken}\r\n            stripeKey='pk_test_51MEakIBldv5L7zd6VIwU8t8Ss5p8oj0gX0gkNbEXdSa5QfdRY4U8Yu4R0qFVjz9FlHBfaBqe8Ljbc5xzzFqXgmaa00bFSEVehl'\r\n            >\r\n                <button style={{cursor:\"pointer\",marginTop:\"30px\",borderRadius:\"10px\",border:0,fontSize:\"20px\",backgroundColor:\"#fa7466\",color:\"white\"}}>Register Now!</button>\r\n            </StripeCheckout>\r\n            {error && <p>{error}</p>}\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default RegisterForCourse"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}